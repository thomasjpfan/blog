<!DOCTYPE html><html lang="en"><head><title>Maximum of free damped oscillators</title><meta charset="utf-8"><meta name="author" content="Thomas J. Fan"><meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1"><link rel="apple-touch-icon" href="https://thomasjpfan.com/favicon_v4.png"><meta property="og:image" content="https://thomasjpfan.com/favicon_v4.png"><meta property="og:type" content="article"><meta property="og:locale" content="en_US"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@thomasjpfan"><meta name="twitter:creator" content="@thomasjpfan"><meta name="twitter:image" content="https://thomasjpfan.com/favicon_v4.png"><meta name="description" property="og:description" content="<p>There are still elementary facts about free damped oscillators that catch me off guard from time to time. One of these facts is that the maximum of the damped oscillation solution is different from the envelope that is tangent to it.</p>"><meta name="description" content="<p>There are still elementary facts about free damped oscillators that catch me off guard from time to time. One of these facts is that the maximum of the damped oscillation solution is different from the envelope that is tangent to it.</p>"><meta name="og:title" property="og:title" content="Maximum of free damped oscillators"><meta name="og:url" property="og:url" content="https://thomasjpfan.com/2014/05/maximum-of-free-damped-oscillators/"><meta name="twitter:title" content="Maximum of free damped oscillators"><meta name="twitter:description" content="<p>There are still elementary facts about free damped oscillators that catch me off guard from time to time. One of these facts is that the maximum of the damped oscillation solution is different from the envelope that is tangent to it.</p>"><link rel="shortcut icon" href="https://thomasjpfan.com/favicon_v5.ico"><link rel="stylesheet" href="https://thomasjpfan.com/theme/css/style0c1abd42.css"><noscript id="katex_deferred"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css"></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/contrib/auto-render.min.js" defer></script><meta name="generator" content="Pelican"><link href="https://thomasjpfan.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="thomasjpfan.com Full Atom Feed"><link href="https://thomasjpfan.com/feeds/blog.atom.xml" type="application/atom+xml" rel="alternate" title="thomasjpfan.com Categories Atom Feed"></head><body><header><div class="header-wrapper"><div class="header-inner-wrapper"><div class="header-brand"><a href="/">tf<span>.</span></a></div><nav><div class="nav-search"><form action="https://thomasjpfan.com/search.html" onsubmit="return validateForm(this.elements['q'].value);"><label for="tipue_search_input" class="visuallyhidden">Search</label><input type="text" class="nav-search--input search-query" placeholder="Search" name="q" id="tipue_search_input"></form></div><div class="nav-links"><div class="nav-link"><a href="https://github.com/thomasjpfan" target="_blank" rel="noopener"><i class="fa fa-github"></i> github</a></div><div class="nav-link"><a href="https://twitter.com/thomasjpfan" target="_blank" rel="noopener"><i class="fa fa-twitter"></i> twitter</a></div><div class="nav-link"><a href="/pages/about/"><i class="fa fa-user"></i> about</a></div><div class="nav-link"><a href="/pages/talks/"><i class="fa fa-flask"></i> talks</a></div></div></nav></div></div></header> <main><article class="content"><div class="article content-wrapper"><h1 class="article-title"><a href rel="bookmark" title="Permalink to Maximum of free damped oscillators"> Maximum of free damped oscillators </a></h1><div class="article-header"><a class="article-header-link" title="2014-05-02T09:29:00-05:00" href="/2014/05/maximum-of-free-damped-oscillators/">May 02, 2014</a><div class="article-header-tags-wrapper"><a class="tag article-header-tag" href="/topic/math/">math</a><a class="tag article-header-tag" href="/topic/physics/">physics</a><a class="tag article-header-tag" href="/topic/python/">python</a></div></div> <div class="entry-content"><p>While reading a <a href="http://www.leancrew.com/all-this/2014/04/damped-free-vibrations/" target="_blank" rel="noopener">blog entry</a> on free damped oscillators by Dr. Drang, I was caught off guard by the fact that the maximum of the damped oscillation solution is different from the envelope that is tangent to it. Looking back, this was obviously since the exponential is a monotonic decreasing function which would change the position of the local maximum of the cosine function. What I took for granted was the fact that the distance between the maximum is the same as the period of the cosine function.</p><p>The solution of the free damped oscillator is</p><div class="math">$$ x(t) = Ae^{-\eta t}\cos(\omega t - \phi), $$</div><p>where <span class="math">\(\eta\)</span> is a damping constant, <span class="math">\(A\)</span> is the amplitude, <span class="math">\(\omega\)</span> is the angular frequency, and <span class="math">\(\phi\)</span> is a phase shift that depends on initial conditions. With <span class="math">\(\eta=0.5\)</span>, <span class="math">\(\omega=2\pi\)</span>, and <span class="math">\(\phi=0\)</span>, this function looks like this:</p><p><img alt="Free damped oscillator" src="/images/20140502_Maximum_of_damped_free_vibrations/freedampedfull.png"></p><p>The red function is <span class="math">\(\pm e^{-\eta t}\)</span>, which is the envelope for <span class="math">\(x(t)\)</span> (the middle function). If you zoom into the peak at <span class="math">\(t=1\)</span>, the difference between the peak of <span class="math">\(x(t)\)</span> and the envelope is apparent:</p><p><img alt="Free damped oscillator zoom" src="/images/20140502_Maximum_of_damped_free_vibrations/freedampedzoom.png"></p><p>What is the actual difference between them? Well that just takes some simple calculus:</p><div class="math">$$ \dfrac{dx}{dt} = -\eta\omega A e^{-\eta t}\cos(\omega t-\phi) - \omega A e^{-\eta t}\sin(\omega t -\phi) $$</div><p>Then taking the derivative and setting it equal to zero:</p><div class="math">$$ -\eta\omega A e^{-\eta t}\cos(\omega t-\phi) - \omega A e^{-\eta t}\sin(\omega t -\phi) = 0 $$</div><p>and solving for <span class="math">\(t\)</span>:</p><div class="math">$$ t_{max} = -\dfrac{1}{\omega}\arctan(\eta) + \dfrac{\phi+2\pi n}{\omega} $$</div><p>where <span class="math">\(n\)</span> is a natural number. The tagent value can be obtained by setting <span class="math">\(x(t)\)</span> equal to the envelope:</p><div class="math">$$ Ae^{-\eta t} = Ae^{-\eta t}\cos(\omega t - \phi) $$</div><p>and then solving for <span class="math">\(t\)</span>:</p><div class="math">$$ t_{tang} = \dfrac{\phi + 2 \pi n}{\omega} $$</div><p>where <span class="math">\(n\)</span> is a natural number. These are the maximum values for a normal cosine function.</p><h2>Summary</h2><p>The difference between <span class="math">\(t_{max}\)</span> and <span class="math">\(t_{tang}\)</span> is:</p><div class="math">$$ t_{tang}-t_{max} = \dfrac{1}{\omega}\arctan(\eta) $$</div><p>This difference is the same for every peak, thus distance between the maximum of <span class="math">\(x(t)\)</span> is the same as the period of the cosine function. Honestly, this post is not that revolutionary, but I just wanted to test out how math renders on my site.</p><h2>Code for Plots</h2><p>For those who are interested, I used matplotlib to generated the graphs above:</p><div class="highlight"><pre><span class="code-line"><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span></span>
<span class="code-line"><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">linspace</span></span>
<span class="code-line"><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">eta</span> <span class="o">=</span> <span class="mf">0.5</span></span>
<span class="code-line"><span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span></span>
<span class="code-line"></span>
<span class="code-line"></span>
<span class="code-line"><span class="k">def</span> <span class="nf">damped_os</span><span class="p">(</span><span class="n">t</span><span class="p">):</span></span>
<span class="code-line">    <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">eta</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">omega</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">t</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span></span>
<span class="code-line"><span class="n">x</span> <span class="o">=</span> <span class="n">damped_os</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></span>
<span class="code-line"><span class="n">x_u</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">eta</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span></span>
<span class="code-line"><span class="n">x_d</span> <span class="o">=</span> <span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">eta</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span></span>
<span class="code-line"><span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_u</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_d</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x/A&#39;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1"># plt.savefig(&#39;{filename}/images/201405_Maximum_of_damped_free_vibrations/freedampedfull.png&#39;)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1"># Zooming</span></span>
<span class="code-line"><span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span></span>
<span class="code-line"><span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"></span>
<span class="code-line"><span class="k">def</span> <span class="nf">neg_damped_os</span><span class="p">(</span><span class="n">t</span><span class="p">):</span></span>
<span class="code-line">    <span class="k">return</span> <span class="o">-</span><span class="n">damped_os</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">result</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">neg_damped_os</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c1"># maximum arrow</span></span>
<span class="code-line"><span class="n">x_max</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">result</span><span class="o">.</span><span class="n">fun</span></span>
<span class="code-line"><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span></span>
<span class="code-line"><span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">-</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span></span>
<span class="code-line">          <span class="n">width</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></span>
<span class="code-line"><span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">dx</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">-</span> <span class="n">dy</span> <span class="o">-</span> <span class="mf">0.005</span><span class="p">))</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">x_tang</span><span class="p">,</span> <span class="n">y_tang</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">damped_os</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span></span>
<span class="code-line"><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.01</span></span>
<span class="code-line"><span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x_tang</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y_tang</span> <span class="o">+</span> <span class="n">dy</span><span class="p">,</span> <span class="o">-</span><span class="n">dx</span><span class="p">,</span> <span class="o">-</span><span class="n">dy</span><span class="p">,</span></span>
<span class="code-line">          <span class="n">width</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></span>
<span class="code-line"><span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;tangent&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x_tang</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">+</span> <span class="mf">0.005</span><span class="p">,</span> <span class="n">y_tang</span> <span class="o">+</span> <span class="n">dy</span><span class="p">))</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;images/201405_Maximum_of_damped_free_vibrations/freedampedzoom.png&#39;</span><span class="p">)</span></span>
<span class="code-line"></code></pre></div><script type="text/javascript">if (!document.getElementById('katexscript_pelican_auto_render_#%@#$@#')) {{

}}

</script></div><div class="article-subtitle"><section class="subtitle"><div class="share-items-wrapper"><h3>Share this post</h3><div class="share-items"><div class="share-item"><a href="https://twitter.com/intent/tweet?original_referer=https://thomasjpfan.com/2014/05/maximum-of-free-damped-oscillators/&text=Maximum of free damped oscillators&url=https://thomasjpfan.com/2014/05/maximum-of-free-damped-oscillators/&via=thomasjpfan" title="Tweet this !" target="_blank" rel="noopener"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-twitter fa-stack-1x fa-inverse"></i></span></a></div><div class="share-item"><a href="http://www.facebook.com/share.php?u=https://thomasjpfan.com/2014/05/maximum-of-free-damped-oscillators/" title="Share this on Facebook" target="_blank" rel="noopener"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-facebook fa-stack-1x fa-inverse"></i></span></a></div><div class="share-item"><a href="mailto:?subject=Maximum of free damped oscillators&body=https://thomasjpfan.com/2014/05/maximum-of-free-damped-oscillators/" title="Email this" class="email" target="_blank" rel="noopener"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-envelope fa-stack-1x fa-inverse"></i></span></a></div></div></div><section class="similar-posts"><h3>Similar Posts</h3><dl class="dl-tags"><dt>09/12/18</dt><dd><a href="/2018/09/survival-regression-analysis-on-customer-churn/">Survival Regression Analysis on Customer Churn</a></dd><dt>07/31/18</dt><dd><a href="/2018/07/nuclei-image-segmentation-tutorial/">Nuclei Image Segmentation Tutorial</a></dd><dt>08/28/17</dt><dd><a href="/2017/08/rodents-of-nyc/">Rodents Of NYC</a></dd><dt>09/12/15</dt><dd><a href="/2015/09/bayesian-coin-flips/">Bayesian Coin Flips</a></dd><dt>08/29/15</dt><dd><a href="/2015/08/statistical-power-of-coin-flips/">Statistical Power of Coin Flips</a></dd></dl></section></section></div></div></article></main><footer><div class="footer-wrapper"><div class="footer-inner-wrapper"><div class="footer-profile"><div class="footer-brand"><a href="/"><span>thomasjpfan.com</span></a></div><div class="footer-about"><p>Thomas J. Fan's personal blog where I share my thoughts and insights.</p></div></div><div class="footer-contact"><span>Contact</span><div class="footer-contact-message"><p>Have any feedback or questions? Just send me a tweet or an email!</p></div><div class="footer-social-items"><ul><li class="footer-social-item"><a href="https://twitter.com/thomasjpfan" title="Tweet me" target="_blank" rel="noopener"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li class="footer-social-item"><script>
                var username = "thomasjpfan";
                var hostname = "gmail.com";
                var linktext = username + "@" + hostname;
                document.write("<a href=\"" + "mailto:" + username + "@" + hostname + "\" title=\"Email me\"target=\"_blank\"><span class=\"fa-stack fa-lg\"><i class=\"fa fa-circle fa-stack-2x\"></i><i class=\"fa fa-envelope fa-stack-1x fa-inverse\"></i></span></a>");
              </script></li></ul></div></div><div class="footer-site-detail"><span>Site</span><ul class="footer-links"><li class="footer-link"><a href="/"><i class="fa fa-th-list"></i> front page</a></li><li class="footer-link"><a href="/archives/"><i class="fa fa-archive"></i> archives</a></li><li class="footer-link"><a href="/topics"><i class="fa fa-tags"></i> topics</a></li><li class="footer-link"><a href="None"><i class="fa fa-rss"></i> rss</a></li></ul></div></div></div></footer> <script>
		function validateForm(query) {
			return (query.length > 0);
		}
	</script><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://thomasjpfan.com/theme/js/tipuesearch.min.js"></script><script>
var loadKatexDeferred = function () {
	var addStylesNode = document.getElementById("katex_deferred");
	var replacement = document.createElement("div");
	replacement.innerHTML = addStylesNode.textContent;
	document.body.appendChild(replacement);
	addStylesNode.parentElement.removeChild(addStylesNode);
};
var renderMath = function () {
	renderMathInElement(document.body, {
		delimiters: [{
				left: "$$",
				right: "$$",
				display: true
			},
			{
				left: "\\[",
				right: "\\]",
				display: true
			},
			{
				left: "$",
				right: "$",
				display: false
			},
			{
				left: "\\(",
				right: "\\)",
				display: false
			}
		]
	});
}

		var renderJqueryDeps = function ($) {
		};

		var loadAll = function () {
loadKatexDeferred();
renderMath();
			renderJqueryDeps(jQuery);
		};

		// var raf = requestAnimationFrame || mozRequestAnimationFrame || webkitRequestAnimationFrame || msRequestAnimationFrame;
		// if (raf) raf(function() { window.setTimeout(loadAll, 0); });
		// else
		// window.addEventListener('load', loadAll);
		(function () {
			var onReady = function onReady(fn) {
			  if (document.addEventListener) {
				document.addEventListener("DOMContentLoaded", fn);
			  } else {
				document.attachEvent("onreadystatechange", function () {
				  if (document.readyState === "interactive") {
					fn();
				  }
				});
			  }
			};

			onReady(function () {
				loadAll();
			});
		  })();
	</script></body></html>